# Matheus Jesus 12-04-2020

## Try Hack Me - Malware Analysis I (https://tryhackme.com/room/malwareanalysisprimer)

### Definitions

* Point of Entry (PoE): How the malware got in
  * Email spam
  * Intentional download
* Is the malware being executed ?
  * Processes
  * Files
  * Communication
* Malware performance
  * Does it infect the network
  * Encrypt files
  * Install backdoor
  * Remote Access Tool
* Detect and Prevent

### Types

#### Targeted

Implemented for a single purpose to a single system

[Ref DarkHotel Malware](https://www.kaspersky.co.uk/resource-center/threats/darkhotel-malware-virus-threat-definition)
[Ref Iran](https://en.wikipedia.org/wiki/Stuxnet)

#### Mass Campaign

Infect many, do damage to everyone

[Ref Yeti](https://www.kaspersky.co.uk/resource-center/threats/crouching-yeti-energetic-bear-malware-threat)
[Wanna Cry](https://en.wikipedia.org/wiki/WannaCry_ransomware_attack)

### Identify

There are four steps on a malware infection

#### 1. Delivery

Maybe through USB, PDF, Phising, Spam

#### 2. Execution

Ransomware - Encrypts files
Spyware - Records Information

#### 3. Maintaining Persistence

#### 4. Propagate

Generates much traffic

#### Signatures

Host - Files, programs and processes on host machine
Network - Network traffic

### Analysis

#### Static

Analysis without code execution but only the state of the files and processes on host

#### Dynamic

Code execution to see the output

Clearly very risky

### First Windows Analysis

#### IP 10.10.238.114

Since we use linux, connect through browser on THM.

#### Always Check MD5s

[Virustotal](https://www.virustotal.com/gui/home)

On task 7, 3 MD5s

D2778164EF643BA8F44CC202EC7EF157
59CB421172A89E1E16C11A428326952C
5416BE1B8B04B1681CB39CF0E2CAAD9F

Hitting on VirusTotal, none of them are harmful

#### Obfuscated Executables

A file maybe executable but have a different extension.
The execution is determined on the file header [Ref](https://www.garykessler.net/library/file_sigs.html)

##### PeID windows tool

Found packaging of files (Microsoft Visual C++ 6.0)

Found a weird packaging (FSG 1.0 -> dulek/xt)

##### IDA Freeware

Drag and Drop file.
It shows the assembly execution and Kernel Imports

The file has been packed, judging by the small number of steps and imports

#### Strings!

Sysinternalssuite windows tool

strings "C:\Users\Analysis\Desktop\Tasks\Task 12\67844C01"

#### PE Explorer

Dropping the same file to PE Explorer showed 5 imports

### Task 14 (DIY)

MD5 Hash F5BD8E6DC6782ED4DFA62B8215BDC429

strings Task14 -> last one is d:h:
